
### 상태 패턴

### 유한상태기계(FSM)

![[Pasted image 20240122212733.png]]

유한 상태 기계(Finite State Machine, FSM)은 객체의 동작이 내부 상태에 따라 달라지는 상황에서 사용되는 개념입니다. 이러한 상황에서 상태 패턴(State Pattern)은 유용하게 활용됩니다. 상태 패턴은 **객체의 상태를 클래스로 추상화하고**, 각 상태마다 해당 상태에서의 동작을 정의합니다. 객체는 현재 상태에 따라 **동작을 수행**하며, **상태 전환**을 통해 다른 동작을 수행할 수 있습니다.

예를 들어, 플레이어의 상태를 관리하는 경우를 생각해보겠습니다. 플레이어는 여러 가지 상태를 가질 수 있으며, 각 상태에서는 특정 동작을 수행합니다. 상태 패턴을 사용하면 플레이어의 상태 관리가 간편해지고, 새로운 상태를 추가하거나 기존 상태를 변경하는 것도 쉬워집니다. 또한, 각 상태의 동작을 분리하여 유지보수성을 높일 수 있습니다.

- 예시 - 플레이어 상태관리
```csharp
// 플레이어 상태 인터페이스
public interface IPlayerState
{
    void EnterState(Player player);
    void ExitState(Player player);
    void UpdateState(Player player);
}

// 정지 상태 클래스
public class IdleState : IPlayerState
{
    public void EnterState(Player player)
    {
        player.AnimateIdle();
    }

    public void ExitState(Player player) { }

    public void UpdateState(Player player)
    {
        if (player.IsMoving)
        {
            player.ChangeState(new MoveState());
        }
    }
}

// 이동 상태 클래스
public class MoveState : IPlayerState
{
    public void EnterState(Player player)
    {
        player.AnimateMove();
    }

    public void ExitState(Player player) { }

    public void UpdateState(Player player)
    {
        if (!player.IsMoving)
        {
            player.ChangeState(new IdleState());
        }
    }
}

// 플레이어 클래스
public class Player
{
    private IPlayerState currentState;

    public bool IsMoving { get; set; }

    public Player()
    {
        currentState = new IdleState();
    }

    public void ChangeState(IPlayerState newState)
    {
        currentState.ExitState(this);
        currentState = newState;
        currentState.EnterState(this);
    }

    public void Update()
    {
        currentState.UpdateState(this);
    }

    public void AnimateIdle()
    {
        // 정지 상태 애니메이션 재생
    }

    public void AnimateMove()
    {
        // 이동 상태 애니메이션 재생
    }
}
	
```