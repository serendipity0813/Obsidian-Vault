## 가비지 컬렉션 (Garbage Collection) 정리

**가비지 컬렉션(GC)**이란 프로그램이 동적으로 할당했던 메모리 영역 중 더 이상 사용하지 않는 영역을 자동으로 해제하는 기능입니다. 이를 통해 개발자는 메모리 관리를 직접 수행하지 않아도 되어 프로그래밍의 편리성을 높이고 메모리 누수(memory leak)를 방지할 수 있습니다.

**1. 개요**

- **역사:** 1959년 무렵 리스프의 문제를 해결하기 위해 존 매카시가 개발했습니다.
- **목적:**
    - 개발자의 메모리 관리 부담을 줄임
    - 메모리 누수를 방지하여 프로그램 안정성을 높임
- **장점:**
    - 프로그래밍 편리성 향상
    - 메모리 누수 방지
    - 안정적인 프로그램 운영
- **단점:**
    - 성능 오버헤드 발생 가능성
    - 제어 어려움
    - 구현 방식에 따라 다양한 문제 발생 가능성

**2. 동작 원리**

- **가비지 컬렉터(GC)**: 메모리 사용状況을 추적하고 더 이상 사용하지 않는 메모리를 찾아 해제하는 프로그램
- **주요 알고리즘:**
    - **참조 횟수 계산:** 객체를 참조하는 변수의 갯수를 기록하여 더 이상 참조되지 않는 객체를 찾아냄
    - **도달 가능성 분석:** 프로그램 실행 경로를 분석하여 도달 가능한 객체와 도달 불가능한 객체를 구분
    - **세대별 가비지 컬렉션:** 객체의 생성 순서를 기반으로 여러 세대로 나누고, 각 세대별 특징에 맞는 알고리즘을 적용
- **GC 수행 시기:**
    - 프로그램 종료 시
    - 메모리 부족 시
    - GC 알고리즘에 따라 정해진 시간 간격으로

**3. 종류**

- **세대별 가비지 컬렉션:** 객체의 생성 순서를 기반으로 여러 세대로 나누고, 각 세대별 특징에 맞는 알고리즘을 적용
    - **장점:** 메모리 효율성 향상
    - **단점:** 구현 복잡성 증가
- **실시간 가비지 컬렉션:** 프로그램 실행 중에 지속적으로 GC를 수행
    - **장점:** 짧은 지연 시간
    - **단점:** 성능 오버헤드 증가
- **참조 횟수 계산:** 객체를 참조하는 변수의 갯수를 기록하여 더 이상 참조되지 않는 객체를 찾아냄
    - **장점:** 구현 간단
    - **단점:** 메모리 누수 가능성

**4. 주의 사항**

- GC는 완벽하지 않아 메모리 누수가 발생할 수 있습니다.
- GC는 성능 오버헤드를 발생시킬 수 있습니다.
- GC 알고리즘에 따라 다양한 문제가 발생할 수 있습니다.

###### 5. 가비지 컬렉터를 회피하기 위한 전략
- 가비지 컬렉터를 회피하기 위한 전략은 다음과 같습니다.
	- **메모리 할당을 최소화한다.**
	- **참조 관계를 최소화한다.**
	- **큰 객체의 할당을 자제한다.**
	- **수동으로 메모리를 해제한다.**

#### 가비지 컬렉션 사용 시기

**1. 일반적인 경우:**

- 프로그램 종료 시: 프로그램이 더 이상 메모리를 사용하지 않을 때
- 메모리 부족 시: 프로그램 실행 중 메모리가 부족할 때
- GC 알고리즘에 따라 정해진 시간 간격으로: 메모리 할당 패턴이 불규칙하거나 메모리 누수 가능성이 높을 때

**2. 특정 상황:**

- 실시간 시스템: 짧은 지연 시간이 중요한 시스템에서는 실시간 가비지 컬렉션을 사용
- 임베디드 시스템: 메모리 자원이 제한적인 시스템에서는 메모리 효율적인 세대별 가비지 컬렉션을 사용
- 고성능 시스템: 성능 오버헤드가 중요한 시스템에서는 참조 횟수 계산과 같은 간단한 알고리즘을 사용

#### 가비지 컬렉션 종류 선택

**1. 주요 고려 사항:**

- 메모리 효율성
- 성능 오버헤드
- 구현 복잡성
- 메모리 누수 가능성

**2. 일반적인 선택 기준:**

- 메모리 효율성 중요: 세대별 가비지 컬렉션
- 성능 오버헤드 중요: 참조 횟수 계산
- 구현 간편함 중요: 참조 횟수 계산
- 실시간 시스템: 실시간 가비지 컬렉션
- 임베디드 시스템: 세대별 가비지 컬렉션
- 고성능 시스템: 참조 횟수 계산

**3. 추가 고려 사항:**

- 특정 프로그래밍 언어 또는 환경에서 지원하는 GC 종류
- 개발자의 경험 및 선호도

#### 가비지 컬렉션 성능 향상 방법

**1. 코딩 방식 개선:**

- 불필요한 객체 생성 최소화
- 객체 참조 횟수 관리
- 힙 크기 조정
- 불변 객체 사용
- finalize() 메서드 주의

**2. GC 알고리즘 선택:**

- 프로그램 특성에 맞는 알고리즘 선택
- 여러 알고리즘 비교 및 테스트

**3. GC 튜닝:**

- GC 관련 옵션 설정
- GC 로그 분석

**4. 기타:**

- 최신 버전의 GC 사용
- 메모리 프로파일러 사용
- 개발자 도구 활용